<h1>List of users</h1>


<hr>

<table border="1">
  <tr>

    <th>
      Username
    </th>

    <th>
      Private?
    </th>
<% if session.fetch(:user_id) == nil%>
<% else%>
    <th>

    </th>
<%end%>

    <th></th>
  </tr>

  <% @users.each do |user| %>
  <tr>

    <td>
      <%= user.username %>
    </td>

      <td>
          <%=if user.private== true then "Yes" else "No" end%>
      </td>

<% if session.fetch(:user_id) == nil%>
<% else%>














<%followinfo = FollowRequest.where({:sender_id => @current_user.id})%>
<%relatedfollowinfo = followinfo.where(:recipient_id => user.id).at(0)%>
<%if relatedfollowinfo == nil%>
 
  <td>
            <form action="/insert_follow_request" method="post">
              <input type="hidden" name="query_recipient_id" value="<%=user.id%>">

              <button>
                Follow
              </button>
            </form>
      </td>

<%elsif relatedfollowinfo.status == "pending"%>

    <td>
    Request sent 
      <a href="//delete_follow_request/<%= relatedfollowinfo.id %>">Cancel</a>
    </td>
<%else%>

    <td>
      <a href="//delete_follow_request/<%= relatedfollowinfo.id %>">Unfollow</a>
    </td>
<%end%>











<%end%>


    <td>
      <a href="/users/<%= user.username %>">Show details</a>
    </td>


  </tr>
  
  <% end %>
</table>
